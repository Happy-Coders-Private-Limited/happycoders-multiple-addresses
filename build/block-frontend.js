(()=>{"use strict";var e,t={433:(e,t,o)=>{const s=window.wp.element,n=window.wp.i18n,c=window.wp.data,a=window.wp.components,r=window.wp.apiFetch;var l=o.n(r);const d=window.ReactJSXRuntime,i=window.hc_wcma_block_params||{},p=i.i18n||{},m=({addressType:e="billing"})=>{const t=i.defaultKeys?.[e]||"",[o,r]=(0,s.useState)(t),[m,u]=(0,s.useState)(""),[h,k]=(0,s.useState)(""),[y,g]=(0,s.useState)(!1),[b,_]=(0,s.useState)(!1),f=i.addresses||{},v=f[e]||{},S=Object.keys(v).length>0?Object.values(v):[],j="yes"===i.allow_new,x=i.selector_style||"dropdown",C=i.existing_nicknames||{},O=(0,s.useCallback)((t=>{g(!0);const o={[e+"_address"]:t};return(0,c.dispatch)("wc/store/cart").updateCustomerData(o,!1).then((()=>{g(!1)})).catch((e=>{throw g(!1),e}))}),[c.dispatch,e]),E=(0,s.useCallback)((t=>{if(r(t),g(!0),"new"===t||""===t){O({first_name:"",last_name:"",company:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:"",phone:"",email:"",nickname:""}).then((()=>{g(!1),w(e,!0)})).catch((()=>{g(!1),w(e,!0)}))}else{const o=f[e]?.[t];if(o){const t={};t.first_name=o.first_name||"",t.last_name=o.last_name||"",t.company=o.company||"",t.address_1=o.address_1||"",t.address_2=o.address_2||"",t.city=o.city||"",t.state=o.state||"",t.postcode=o.postcode||"",t.country=o.country||"",t.phone=o.phone||"",t.email=o.email||"",t.nickname=o.nickname||"",O(t).then((()=>{g(!1),w(e,!1)})).catch((()=>{g(!1),w(e,!0)}))}else w(e,!0),g(!1)}}),[e,f,O]);(0,s.useEffect)((()=>{if(t&&v[t]){r(t);const o=v[t],s={};s.first_name=o.first_name||"",s.last_name=o.last_name||"",s.company=o.company||"",s.address_1=o.address_1||"",s.address_2=o.address_2||"",s.city=o.city||"",s.state=o.state||"",s.postcode=o.postcode||"",s.country=o.country||"",s.phone=o.phone||"",s.email=o.email||"",s.nickname=o.nickname||"",O(s).then((()=>w(e,!1))).catch((()=>w(e,!0)))}else 0===S.length&&_(!0),r(""),w(e,!0)}),[t,e,v,O]),(0,s.useEffect)((()=>{if("new"===o||b){const t={address_type:e,nickname_type:m,nickname:h};l()({path:"/hc-wcma/v1/save-nickname",method:"POST",headers:{"Content-Type":"application/json"},data:t}).then((e=>{e.success||console.error("Error saving nickname:",e.message)})).catch((e=>{console.error("Error saving nickname:",e)}))}}),[m,h,o,e,b]);const M=[];if(S.forEach((e=>{if(!e.key)return;let o=e.nickname||e.address_1||e.city||e.key;e.key===t&&(o+=` ${p.default_label||"(Default)"}`),M.push({label:o,value:e.key})})),j&&M.push({label:p.new_address||"Enter a new address",value:"new"}),M.length<1&&!b)return null;const T=[{label:p.select_nickname||(0,n.__)("Select Nickname","happycoders-multiple-addresses"),value:""},{label:p.home||(0,n.__)("Home","happycoders-multiple-addresses"),value:"Home",disabled:C[e]?.includes("Home")},{label:p.work||(0,n.__)("Work","happycoders-multiple-addresses"),value:"Work",disabled:C[e]?.includes("Work")},{label:p.other||(0,n.__)("Other","happycoders-multiple-addresses"),value:"Other"}];try{return(0,d.jsxs)("div",{className:`hc-wcma-block-checkout-selector hc-wcma-${e}-selector ${y?"is-loading":""} wp-block-hc-wcma-address-selector`,children:[(0,d.jsxs)("div",{style:{marginBottom:"1em",opacity:y?.5:1,pointerEvents:y?"none":"auto"},children:["list"===x?(0,d.jsx)(a.RadioControl,{selected:o,options:M,onChange:E,className:"hc-wcma-address-radio-list"}):(0,d.jsx)(a.SelectControl,{value:o,options:M,onChange:E,className:"hc-wcma-address-select"}),("new"===o||b)&&(0,d.jsxs)("div",{className:"hc-wcma-nickname-fields",children:[(0,d.jsx)(a.SelectControl,{label:p.address_nickname_type||(0,n.__)("Address Nickname Type","happycoders-multiple-addresses"),value:m,options:T,onChange:e=>u(e)}),"Other"===m&&(0,d.jsx)(a.TextControl,{label:p.custom_nickname||(0,n.__)("Custom Nickname","happycoders-multiple-addresses"),value:h,onChange:e=>k(e)})]})]}),y&&(0,d.jsx)("p",{className:"hc-wcma-loading-text",children:p.loading||"Loading..."})]})}catch(e){return(0,d.jsx)("p",{style:{color:"red",border:"1px solid red",padding:"5px"},children:"Error rendering HCMA selector!"})}};function u(){const e=i.addresses||{},t=e.billing&&Object.keys(e.billing).length>0,o=e.shipping&&Object.keys(e.shipping).length>0,n="yes"===i.allow_new;if(t||n){const e=document.querySelector(".wp-block-woocommerce-checkout-billing-address-block .wc-block-components-checkout-step__content");if(e){const t=document.createElement("div");if(t.className="hc-wcma-billing-mount-point",e.prepend(t),!t.dataset.reactMounted)try{(0,s.render)((0,d.jsx)(m,{addressType:"billing"}),t),t.dataset.reactMounted="true"}catch(e){console.error("[HCMA Blocks Frontend] Error mounting billing component:",e)}}}else console.log("[HCMA Blocks Frontend] Skipping Billing selector - no addresses and new not allowed.");if(o||n){const e=document.querySelector(".wp-block-woocommerce-checkout-shipping-address-block .wc-block-components-checkout-step__content");if(e){const t=document.createElement("div");if(t.className="hc-wcma-shipping-mount-point",e.prepend(t),!t.dataset.reactMounted)try{(0,s.render)((0,d.jsx)(m,{addressType:"shipping"}),t),t.dataset.reactMounted="true"}catch(e){console.error("[HCMA Blocks Frontend] Error mounting shipping component:",e)}}}else console.log("[HCMA Blocks Frontend] Skipping Shipping selector.");setTimeout(h,100)}function h(){const e=document.querySelectorAll(".wc-block-components-address-card .wc-block-components-address-card__edit");e.length>0&&e.forEach((e=>{e.style.display="none"}))}function k(e){const t=i.addresses||{},o=t[e]&&Object.keys(t[e]).length>0,n="yes"===i.allow_new;if(!o&&!n)return;const c=`.wp-block-woocommerce-checkout-${e}-address-block .wc-block-components-checkout-step__content`,a=document.querySelector(c);if(a){let t=a.querySelector(`.hc-wcma-${e}-mount-point`);if(t)!function(e,...t){const o=new Date,s=`${String(o.getHours()).padStart(2,"0")}:${String(o.getMinutes()).padStart(2,"0")}:${String(o.getSeconds()).padStart(2,"0")}.${String(o.getMilliseconds()).padStart(3,"0")}`;console.log(`[${s}] ${e}`,...t)}(`Mount point already exists for ${e}.`);else{t=document.createElement("div"),t.className=`hc-wcma-${e}-mount-point`;const o=a.querySelector(".wc-block-components-checkout-step__content");o?o.parentNode.insertBefore(t,o):a.prepend(t)}if(!t.dataset.reactMounted)try{(0,s.render)((0,d.jsx)(m,{addressType:e}),t),t.dataset.reactMounted="true",w(e,!1)}catch(t){console.error(`Error mounting ${e} component:`,t)}}}function w(e,t){const o=`#${e}-fields .wc-block-components-address-address-wrapper`,s=document.querySelector(o);s?t?s.classList.add("is-editing"):(s.classList.remove("is-editing"),setTimeout((()=>h()),100)):console.warn(`[HCMA Blocks ${e}] Wrapper '${o}' not found to toggle is-editing.`)}let y=null;function g(){const e=document.querySelector(".wp-block-woocommerce-checkout");e&&(y||(y=new MutationObserver((e=>{let t=!1,o=!1;for(const s of e)if("childList"===s.type&&s.addedNodes.length>0&&s.addedNodes.forEach((e=>{1===e.nodeType&&((e.matches(".wp-block-woocommerce-checkout-billing-address-block")||e.querySelector(".wp-block-woocommerce-checkout-billing-address-block"))&&(t=!0),(e.matches(".wp-block-woocommerce-checkout-shipping-address-block")||e.querySelector(".wp-block-woocommerce-checkout-shipping-address-block"))&&(o=!0))})),t&&o)break;t&&setTimeout((()=>k("billing")),150),o&&setTimeout((()=>k("shipping")),150)})),y.observe(e,{childList:!0,subtree:!0})))}document.addEventListener("DOMContentLoaded",(()=>{setTimeout(u,750),setTimeout(g,1500)}))}},o={};function s(e){var n=o[e];if(void 0!==n)return n.exports;var c=o[e]={exports:{}};return t[e](c,c.exports,s),c.exports}s.m=t,e=[],s.O=(t,o,n,c)=>{if(!o){var a=1/0;for(i=0;i<e.length;i++){for(var[o,n,c]=e[i],r=!0,l=0;l<o.length;l++)(!1&c||a>=c)&&Object.keys(s.O).every((e=>s.O[e](o[l])))?o.splice(l--,1):(r=!1,c<a&&(a=c));if(r){e.splice(i--,1);var d=n();void 0!==d&&(t=d)}}return t}c=c||0;for(var i=e.length;i>0&&e[i-1][2]>c;i--)e[i]=e[i-1];e[i]=[o,n,c]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={15:0,278:0};s.O.j=t=>0===e[t];var t=(t,o)=>{var n,c,[a,r,l]=o,d=0;if(a.some((t=>0!==e[t]))){for(n in r)s.o(r,n)&&(s.m[n]=r[n]);if(l)var i=l(s)}for(t&&t(o);d<a.length;d++)c=a[d],s.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return s.O(i)},o=globalThis.webpackChunkhappycoders_multiple_addresses=globalThis.webpackChunkhappycoders_multiple_addresses||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var n=s.O(void 0,[278],(()=>s(433)));n=s.O(n)})();