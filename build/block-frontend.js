(()=>{"use strict";var e,t={433:(e,t,o)=>{const n=window.wp.element,s=window.wp.i18n,c=window.wp.data,a=window.wp.components,r=window.wp.apiFetch;var l=o.n(r);const d=window.ReactJSXRuntime,i=window.hc_wcma_block_params||{},p=i.i18n||{},m=({addressType:e="billing"})=>{const t=i.defaultKeys?.[e]||"",[o,r]=(0,n.useState)(t),[m,u]=(0,n.useState)(""),[h,w]=(0,n.useState)(""),[y,g]=(0,n.useState)(!1),[b,_]=(0,n.useState)(!1),f=i.addresses||{},v=f[e]||{},S=Object.keys(v).length>0?Object.values(v):[],C="yes"===i.allow_new,j=i.selector_style||"dropdown",x=i.existing_nicknames||{},O=(0,n.useCallback)((t=>{g(!0);const o={[e+"_address"]:t};return(0,c.dispatch)("wc/store/cart").updateCustomerData(o,!1).then((()=>{g(!1)})).catch((e=>{throw g(!1),e}))}),[c.dispatch,e]),E=(0,n.useCallback)((t=>{if(r(t),g(!0),"new"===t||""===t){O({first_name:"",last_name:"",company:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:"",phone:"",email:"",nickname:""}).then((()=>{g(!1),k(e,!0)})).catch((()=>{g(!1),k(e,!0)}))}else{const o=f[e]?.[t];if(o){const t={};t.first_name=o.first_name||"",t.last_name=o.last_name||"",t.company=o.company||"",t.address_1=o.address_1||"",t.address_2=o.address_2||"",t.city=o.city||"",t.state=o.state||"",t.postcode=o.postcode||"",t.country=o.country||"",t.phone=o.phone||"",t.email=o.email||"",t.nickname=o.nickname||"",O(t).then((()=>{g(!1),k(e,!1)})).catch((()=>{g(!1),k(e,!0)}))}else k(e,!0),g(!1)}}),[e,f,O]);(0,n.useEffect)((()=>{if(t&&v[t]){r(t);const o=v[t],n={};n.first_name=o.first_name||"",n.last_name=o.last_name||"",n.company=o.company||"",n.address_1=o.address_1||"",n.address_2=o.address_2||"",n.city=o.city||"",n.state=o.state||"",n.postcode=o.postcode||"",n.country=o.country||"",n.phone=o.phone||"",n.email=o.email||"",n.nickname=o.nickname||"",O(n).then((()=>k(e,!1))).catch((()=>k(e,!0)))}else 0===S.length&&_(!0),r(""),k(e,!0)}),[t,e,v,O]),(0,n.useEffect)((()=>{if("new"===o||b){const t={address_type:e,nickname_type:m,nickname:h};l()({path:"/hc-wcma/v1/save-nickname",method:"POST",headers:{"Content-Type":"application/json"},data:t}).then((e=>{e.success||console.error("Error saving nickname:",e.message)})).catch((e=>{console.error("Error saving nickname:",e)}))}}),[m,h,o,e,b]);const M=[];if(S.forEach((e=>{if(!e.key)return;let o=e.nickname||e.address_1||e.city||e.key;e.key===t&&(o+=` ${p.default_label||"(Default)"}`),M.push({label:o,value:e.key})})),C&&M.push({label:p.new_address||"Enter a new address",value:"new"}),M.length<1&&!b)return null;const T=[{label:p.select_nickname||(0,s.__)("Select Nickname","happycoders-multiple-addresses"),value:""},{label:p.home||(0,s.__)("Home","happycoders-multiple-addresses"),value:"Home",disabled:x[e]?.includes("Home")},{label:p.work||(0,s.__)("Work","happycoders-multiple-addresses"),value:"Work",disabled:x[e]?.includes("Work")},{label:p.other||(0,s.__)("Other","happycoders-multiple-addresses"),value:"Other"}];try{return(0,d.jsxs)("div",{className:`hc-wcma-block-checkout-selector hc-wcma-${e}-selector ${y?"is-loading":""} wp-block-hc-wcma-address-selector`,children:[(0,d.jsxs)("div",{style:{marginBottom:"1em",opacity:y?.5:1,pointerEvents:y?"none":"auto"},children:["list"===j?(0,d.jsx)(a.RadioControl,{selected:o,options:M,onChange:E,className:"hc-wcma-address-radio-list"}):(0,d.jsx)(a.SelectControl,{value:o,options:M,onChange:E,className:"hc-wcma-address-select"}),("new"===o||b)&&(0,d.jsxs)("div",{className:"hc-wcma-nickname-fields",children:[(0,d.jsx)(a.SelectControl,{label:p.address_nickname_type||(0,s.__)("Address Nickname Type","happycoders-multiple-addresses"),value:m,options:T,onChange:e=>u(e)}),"Other"===m&&(0,d.jsx)(a.TextControl,{label:p.custom_nickname||(0,s.__)("Custom Nickname","happycoders-multiple-addresses"),value:h,onChange:e=>w(e)})]})]}),y&&(0,d.jsx)("p",{className:"hc-wcma-loading-text",children:p.loading||"Loading..."})]})}catch(e){return(0,d.jsx)("p",{style:{color:"red",border:"1px solid red",padding:"5px"},children:"Error rendering HCMA selector!"})}};function u(){const e=i.addresses||{},t=e.billing&&Object.keys(e.billing).length>0,o=e.shipping&&Object.keys(e.shipping).length>0,s="yes"===i.allow_new;if(t||s){const e=document.querySelector(".wp-block-woocommerce-checkout-billing-address-block .wc-block-components-checkout-step__content");if(e){const t=document.createElement("div");if(t.className="hc-wcma-billing-mount-point",e.prepend(t),!t.dataset.reactMounted)try{(0,n.render)((0,d.jsx)(m,{addressType:"billing"}),t),t.dataset.reactMounted="true"}catch(e){console.error("[HCMA Blocks Frontend] Error mounting billing component:",e)}}}else console.log("[HCMA Blocks Frontend] Skipping Billing selector - no addresses and new not allowed.");if(o||s){const e=document.querySelector(".wp-block-woocommerce-checkout-shipping-address-block .wc-block-components-checkout-step__content");if(e){const t=document.createElement("div");if(t.className="hc-wcma-shipping-mount-point",e.prepend(t),!t.dataset.reactMounted)try{(0,n.render)((0,d.jsx)(m,{addressType:"shipping"}),t),t.dataset.reactMounted="true"}catch(e){console.error("[HCMA Blocks Frontend] Error mounting shipping component:",e)}}}else console.log("[HCMA Blocks Frontend] Skipping Shipping selector.");setTimeout(h,100)}function h(){const e=document.querySelectorAll(".wc-block-components-address-card .wc-block-components-address-card__edit");e.length>0&&e.forEach((e=>{e.style.display="none"}))}function k(e,t){const o=`#${e}-fields .wc-block-components-address-address-wrapper`,n=document.querySelector(o);n?t?n.classList.add("is-editing"):(n.classList.remove("is-editing"),setTimeout((()=>h()),100)):console.warn(`[HCMA Blocks ${e}] Wrapper '${o}' not found to toggle is-editing.`)}let w=null;function y(){const e=document.querySelector(".wp-block-woocommerce-checkout");e&&(w?g("Checkout observer already running."):(w=new MutationObserver((e=>{let t=!1;for(const o of e)if("childList"===o.type&&o.addedNodes.length>0&&o.addedNodes.forEach((e=>{1===e.nodeType&&(e.matches(".wp-block-woocommerce-checkout-billing-address-block")||e.querySelector(".wp-block-woocommerce-checkout-billing-address-block"))&&(t=!0)})),t)break;t&&setTimeout((()=>function(e){const t=i.addresses||{},o=t[e]&&Object.keys(t[e]).length>0,s="yes"===i.allow_new;if(!o&&!s)return;const c=document.querySelector(".wp-block-woocommerce-checkout-billing-address-block .wc-block-components-checkout-step__content");if(c){let t=c.querySelector(`.hc-wcma-${e}-mount-point`);if(t)g(`Mount point already exists for ${e}.`);else{t=document.createElement("div"),t.className=`hc-wcma-${e}-mount-point`;const o=c.querySelector(".wc-block-components-checkout-step__content");o?o.parentNode.insertBefore(t,o):c.prepend(t)}if(!t.dataset.reactMounted)try{(0,n.render)((0,d.jsx)(m,{addressType:e}),t),t.dataset.reactMounted="true",k(e,!1)}catch(t){console.error(`Error mounting ${e} component:`,t)}}}("billing")),150)})),w.observe(e,{childList:!0,subtree:!0})))}function g(e,...t){const o=new Date,n=`${String(o.getHours()).padStart(2,"0")}:${String(o.getMinutes()).padStart(2,"0")}:${String(o.getSeconds()).padStart(2,"0")}.${String(o.getMilliseconds()).padStart(3,"0")}`;console.log(`[${n}] ${e}`,...t)}document.addEventListener("DOMContentLoaded",(()=>{setTimeout(u,750),setTimeout(y,1500)}))}},o={};function n(e){var s=o[e];if(void 0!==s)return s.exports;var c=o[e]={exports:{}};return t[e](c,c.exports,n),c.exports}n.m=t,e=[],n.O=(t,o,s,c)=>{if(!o){var a=1/0;for(i=0;i<e.length;i++){for(var[o,s,c]=e[i],r=!0,l=0;l<o.length;l++)(!1&c||a>=c)&&Object.keys(n.O).every((e=>n.O[e](o[l])))?o.splice(l--,1):(r=!1,c<a&&(a=c));if(r){e.splice(i--,1);var d=s();void 0!==d&&(t=d)}}return t}c=c||0;for(var i=e.length;i>0&&e[i-1][2]>c;i--)e[i]=e[i-1];e[i]=[o,s,c]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={15:0,278:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var s,c,[a,r,l]=o,d=0;if(a.some((t=>0!==e[t]))){for(s in r)n.o(r,s)&&(n.m[s]=r[s]);if(l)var i=l(n)}for(t&&t(o);d<a.length;d++)c=a[d],n.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return n.O(i)},o=globalThis.webpackChunkhappycoders_multiple_addresses=globalThis.webpackChunkhappycoders_multiple_addresses||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var s=n.O(void 0,[278],(()=>n(433)));s=n.O(s)})();